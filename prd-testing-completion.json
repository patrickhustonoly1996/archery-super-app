{
  "name": "Testing Completion & Documentation Update",
  "description": "Complete remaining tests (Phase E integration + bow training), fix P0 timer bug, and update all roadmap documentation as complete",
  "branchName": "ralph/testing-completion",
  "userStories": [
    {
      "id": "US-001",
      "title": "Fix P0: Bow training timer doesn't pause when app backgrounds",
      "description": "As a user, I want the bow training timer to pause when I switch apps so my training session isn't ruined",
      "acceptanceCriteria": [
        "BowTrainingProvider implements WidgetsBindingObserver",
        "Timer pauses automatically when app goes to background (AppLifecycleState.paused)",
        "Add _wasAutoPaused flag to track auto-pause state",
        "When app resumes, show visual indicator that session was paused (don't auto-resume)",
        "User must tap to resume after auto-pause",
        "flutter test passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "This is a P0 issue from CODE_REVIEW_AND_UPGRADE_ROADMAP.md. Reference lib/providers/bow_training_provider.dart. The fix pattern is documented in the roadmap.",
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-002",
      "title": "Phase E1: Test bow training provider - timer logic",
      "description": "As a developer, I want comprehensive tests for bow training timer logic so training sessions work correctly",
      "acceptanceCriteria": [
        "Create test/providers/bow_training_provider_test.dart",
        "Test startSession() initializes correct exercise, phase, rep count",
        "Test timer advances through hold -> rest -> hold cycle correctly",
        "Test rep counting increments after each hold/rest cycle",
        "Test exercise advances after all reps complete",
        "Test session completes after all exercises done",
        "Test pauseTimer() stops the timer and preserves state",
        "Test resumeTimer() continues from paused state",
        "Test cancelSession() cleans up all state",
        "flutter test passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Reference lib/providers/bow_training_provider.dart. Use fake timers to test time-based logic without waiting.",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-003",
      "title": "Phase E1: Test bow training provider - phase transitions",
      "description": "As a developer, I want tests for bow training phase transitions so exercise flow is verified",
      "acceptanceCriteria": [
        "Test _advancePhase() transitions from hold to rest correctly",
        "Test _advancePhase() transitions from rest to hold correctly",
        "Test _advancePhase() handles exercise breaks between exercises",
        "Test phase durations are applied correctly from exercise config",
        "Test feedback mode captures timing during hold phase",
        "Test warm-up phase is skipped when disabled",
        "flutter test passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Test the internal phase state machine. May need to expose some internal state for testing or use integration tests.",
      "dependsOn": [
        "US-002"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-004",
      "title": "Phase E1: Test bow training provider - lifecycle and persistence",
      "description": "As a developer, I want tests for bow training app lifecycle so sessions survive app backgrounding",
      "acceptanceCriteria": [
        "Test didChangeAppLifecycleState pauses timer when app goes to background",
        "Test _wasAutoPaused flag is set when auto-paused",
        "Test timer does NOT auto-resume when app returns to foreground",
        "Test exportState() captures all session state for persistence",
        "Test restoreState() reconstructs session from saved state",
        "Test state persistence roundtrip (export -> restore -> export matches)",
        "flutter test passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Tests the P0 fix from US-001. Use WidgetsBinding.instance.handleAppLifecycleStateChanged for testing.",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-005",
      "title": "Phase E2: Test plotting flow integration",
      "description": "As a developer, I want integration tests for the arrow plotting flow so the core UX is verified",
      "acceptanceCriteria": [
        "Create test/integration/plotting_flow_test.dart",
        "Test start session -> select round -> proceed to plotting screen",
        "Test plot arrow -> score calculated -> arrow appears in scorecard",
        "Test plot multiple arrows -> end totals update correctly",
        "Test commit end -> advance to next end",
        "Test complete all ends -> session marked complete",
        "Test undo arrow -> removes last plotted arrow",
        "Test cancel session -> returns to home with session deleted",
        "flutter test passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Use WidgetTester for integration tests. Reference lib/screens/plotting_screen.dart, lib/providers/session_provider.dart",
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-006",
      "title": "Phase E3: Test import flow integration",
      "description": "As a developer, I want integration tests for CSV import so data import UX is verified",
      "acceptanceCriteria": [
        "Create test/integration/import_flow_test.dart",
        "Test navigate to import screen from home",
        "Test paste CSV data -> preview shows parsed rows",
        "Test confirm import -> data saved to database",
        "Test import summary shows count of imported vs skipped rows",
        "Test cancel mid-import returns to previous screen",
        "Test error state shown for completely invalid data",
        "flutter test passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Use WidgetTester. Reference lib/screens/import_screen.dart, lib/services/import_service.dart",
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-007",
      "title": "Phase E4: Test bow training flow integration",
      "description": "As a developer, I want integration tests for bow training so the training UX is verified",
      "acceptanceCriteria": [
        "Create test/integration/bow_training_flow_test.dart",
        "Test navigate to bow training -> select exercise -> start session",
        "Test timer display updates during hold phase",
        "Test rest phase shows correct UI",
        "Test pause button pauses timer and shows paused state",
        "Test resume button continues session",
        "Test complete session shows summary/completion screen",
        "Test cancel mid-session returns to home",
        "flutter test passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Use WidgetTester with fake async for timer testing. Reference lib/screens/bow_training_screen.dart",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-008",
      "title": "Phase E5: Test breath training flow integration",
      "description": "As a developer, I want integration tests for breath training so breathing UX is verified",
      "acceptanceCriteria": [
        "Create test/integration/breath_training_flow_test.dart",
        "Test navigate to breath training -> select mode (hold/paced)",
        "Test breath hold: start -> timer counts up -> tap to end -> record shown",
        "Test paced breathing: start -> phase indicator shows inhale/hold/exhale cycle",
        "Test pause functionality during session",
        "Test complete session shows stats",
        "flutter test passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "Reference lib/screens/breath_training/ folder. Tests for breath_hold_screen.dart and paced_breathing_screen.dart",
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-009",
      "title": "Update TESTING_ROADMAP.md - Mark all phases complete",
      "description": "As a maintainer, I want the testing roadmap updated to reflect completion status",
      "acceptanceCriteria": [
        "Update Current Status section with new test count (run flutter test --reporter=expanded | tail to get exact count)",
        "Update Coverage Summary table with new coverage percentages",
        "Mark all Gap sections as resolved with completion notes",
        "Update Progress Tracking table: mark phases A1-A5, B1-B5, C1-C4, D1-D3, E1-E5 as DONE with test counts and today's date",
        "Update Summary for Patrick section to reflect completion",
        "Add completion date and final test count at bottom",
        "flutter test passes (verify no regressions)"
      ],
      "priority": 9,
      "passes": true,
      "notes": "File: docs/TESTING_ROADMAP.md. Be accurate with test counts - run flutter test to get the real numbers.",
      "dependsOn": [
        "US-001",
        "US-002",
        "US-003",
        "US-004",
        "US-005",
        "US-006",
        "US-007",
        "US-008"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-010",
      "title": "Update CODE_REVIEW_AND_UPGRADE_ROADMAP.md - Mark testing complete",
      "description": "As a maintainer, I want the code review roadmap updated to reflect testing completion",
      "acceptanceCriteria": [
        "Update Testing Assessment section with new test count and coverage estimate",
        "Mark P0 issue 'Timer doesn't pause on background' as FIXED",
        "Update Phase 2: Testing Foundation section to show completion",
        "Update Summary Metrics table - Test Coverage row should show new percentage",
        "Update Quality Scorecard Summary - Test Coverage grade should improve from D+ to B or better",
        "Add note at top of document with last update date",
        "Do NOT change other sections that weren't addressed in this testing work"
      ],
      "priority": 10,
      "passes": true,
      "notes": "File: docs/CODE_REVIEW_AND_UPGRADE_ROADMAP.md. Only update testing-related sections. Keep other improvement areas as-is for future work.",
      "dependsOn": [
        "US-009"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-011",
      "title": "Final verification and commit",
      "description": "As a developer, I want all changes committed with passing tests",
      "acceptanceCriteria": [
        "Run flutter test - ALL tests must pass",
        "Run flutter analyze - no errors (warnings OK)",
        "Commit all changes with message 'Complete testing roadmap: Phase E integration tests, bow training P0 fix, documentation updates'",
        "Push to main branch",
        "Report final test count to confirm completion"
      ],
      "priority": 11,
      "passes": false,
      "notes": "This is the final verification step. Do not proceed if any tests fail.",
      "dependsOn": [
        "US-009",
        "US-010"
      ]
    }
  ],
  "metadata": {
    "createdAt": "2026-01-16T11:00:00.000Z",
    "estimatedIterations": 11,
    "purpose": "Complete all remaining testing work and update documentation to reflect full completion",
    "updatedAt": "2026-01-16T21:52:08.027Z"
  }
}