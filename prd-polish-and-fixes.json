{
  "name": "Polish & Fixes Completion",
  "branchName": "polish-and-fixes",
  "userStories": [
    {
      "id": "US-001",
      "title": "Silent CSV Import Failures",
      "description": "Fix silent CSV import failures. When importing scores or volume data, invalid rows are silently skipped. User thinks import succeeded but data is missing.",
      "acceptanceCriteria": [
        "Track skipped rows with reason (invalid date, bad score, etc.)",
        "After import, show summary dialog: Imported X scores, skipped Y rows",
        "If rows skipped, show expandable list of skipped rows with line numbers and reasons",
        "Allow user to copy skipped rows to clipboard for manual fixing",
        "If ALL rows fail, show error state (not success with 0 imported)",
        "Import 10 valid rows + 2 invalid rows shows 'Imported 10, skipped 2'",
        "Click 'View skipped' shows line numbers and reasons",
        "Import file with all invalid rows shows error, not success"
      ],
      "priority": 1,
      "passes": true,
      "dependsOn": []
    },
    {
      "id": "US-002",
      "title": "ID Collision Risk",
      "description": "Fix ID collision risk. IDs generated using DateTime.now().millisecondsSinceEpoch can collide if two items created in same millisecond.",
      "acceptanceCriteria": [
        "Add uuid package to pubspec.yaml",
        "Replace all DateTime.now().millisecondsSinceEpoch.toString() with const Uuid().v4()",
        "Audit codebase for any other millisecond-based ID generation",
        "Create two bows rapidly - both have unique UUIDs",
        "Import scores quickly - no ID collisions",
        "All existing data continues to work (UUIDs are strings, same as before)"
      ],
      "priority": 1,
      "passes": true,
      "dependsOn": []
    },
    {
      "id": "US-003",
      "title": "Error Handling Wrapper",
      "description": "Create error handling infrastructure. Errors are silently swallowed throughout the app. User never knows when something fails.",
      "acceptanceCriteria": [
        "Create lib/utils/error_handler.dart with ErrorHandler.run() method",
        "Wrapper executes async action and shows loading state (optional)",
        "On success show success snackbar (optional)",
        "On error show error snackbar with retry option",
        "Log errors to debug console",
        "Apply to critical operations: save session, import data, sync to cloud",
        "Network fails during backup shows 'Backup failed' with retry button",
        "Database write fails shows error message, not silent failure"
      ],
      "priority": 2,
      "passes": true,
      "dependsOn": []
    },
    {
      "id": "US-004",
      "title": "Form Validation Mixin",
      "description": "Create form validation. Forms accept any input without validation. Login, equipment forms have no validation.",
      "acceptanceCriteria": [
        "Create lib/mixins/form_validation_mixin.dart",
        "Include validators for: email (format check), required field (non-empty), number (with optional min/max), password (min length)",
        "Apply to login screen",
        "Apply to equipment creation forms (bow name required, etc.)",
        "Login with invalid email shows 'Invalid email format' inline",
        "Create bow with empty name shows 'Name required'",
        "Validation shows as user types (not just on submit)"
      ],
      "priority": 2,
      "passes": true,
      "dependsOn": []
    },
    {
      "id": "US-005",
      "title": "Empty State Widget",
      "description": "Create empty state widget. Screens show nothing when data is empty. User doesn't know what to do.",
      "acceptanceCriteria": [
        "Create lib/widgets/empty_state.dart",
        "Props: icon, title, subtitle (optional), action button (optional)",
        "Apply to history screen (no sessions)",
        "Apply to equipment screen (no bows/quivers)",
        "Apply to statistics screen (no data for charts)",
        "New user with no sessions sees 'No sessions yet' with 'Start Your First Session' button",
        "No bows shows 'No bows added' with 'Add Bow' button",
        "Empty states match app aesthetic (dark + gold)"
      ],
      "priority": 2,
      "passes": true,
      "dependsOn": []
    },
    {
      "id": "US-006",
      "title": "Loading Button Component",
      "description": "Create loading button component. Buttons don't show loading state during async operations. Users tap multiple times.",
      "acceptanceCriteria": [
        "Create lib/widgets/loading_button.dart",
        "Props: label, onPressed, isLoading",
        "When loading: show spinner, disable button",
        "Apply to: login button, save buttons, import confirm",
        "Tap login shows button spinner and can't tap again",
        "Operation completes and button returns to normal"
      ],
      "priority": 3,
      "passes": true,
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-007",
      "title": "Undo for Destructive Operations",
      "description": "Add undo for destructive operations. Deleting sessions, equipment is permanent with no undo.",
      "acceptanceCriteria": [
        "After delete, show snackbar with 'Undo' action for 5 seconds",
        "If undo tapped, restore the item",
        "Apply to: session delete, bow delete, quiver delete, shaft delete",
        "Implementation: soft delete (mark as deleted, purge after undo window)",
        "Delete session shows 'Session deleted' with Undo button",
        "Tap Undo within 5s restores session",
        "Wait 5s and session is permanently gone"
      ],
      "priority": 3,
      "passes": true,
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-008",
      "title": "Offline Indicator",
      "description": "Add offline indicator. User doesn't know their connectivity status or if data is syncing.",
      "acceptanceCriteria": [
        "Show subtle indicator in app bar when offline",
        "Show sync status indicator when backup in progress",
        "Use connectivity_plus package to detect network state",
        "Offline shows small icon in app bar (cloud with X)",
        "Syncing shows small spinning icon",
        "Online and synced shows no indicator (clean state)",
        "Turn off wifi and see offline indicator appear",
        "Turn on wifi and indicator disappears"
      ],
      "priority": 3,
      "passes": true,
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-009",
      "title": "Extract Constants",
      "description": "Extract magic numbers to constants. Magic numbers scattered throughout codebase.",
      "acceptanceCriteria": [
        "Create lib/config/app_constants.dart",
        "Move plotting offsets (60.0 finger offset)",
        "Move linecutter threshold (0.04)",
        "Move scorecard column widths",
        "Move touch target sizes",
        "Document each constant's purpose",
        "All magic numbers have named constants",
        "Each constant has comment explaining its purpose",
        "No behaviour change (pure refactor)"
      ],
      "priority": 4,
      "passes": true,
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-010",
      "title": "Extract Shared Widgets",
      "description": "Extract shared widgets. Score display, card layouts duplicated across screens.",
      "acceptanceCriteria": [
        "Create lib/widgets/score_display.dart - reusable score with optional max/X count",
        "Identify and extract other duplicated widgets",
        "Update screens to use shared widgets",
        "Score displays look identical across all screens (using same widget)",
        "Reduced code duplication",
        "No visual changes"
      ],
      "priority": 4,
      "passes": true,
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-011",
      "title": "Replace Print with Logging",
      "description": "Replace print() statements with proper logging. print() statements in production code, inconsistent logging.",
      "acceptanceCriteria": [
        "Replace all print() with debugPrint() (only runs in debug mode)",
        "For important operations, use structured logging",
        "Primary file: lib/services/firestore_sync_service.dart (20+ print calls)",
        "No print() calls in lib/ (only debugPrint)",
        "Production builds don't log to console",
        "Debug builds still show useful logs"
      ],
      "priority": 4,
      "passes": false,
      "dependsOn": []
    },
    {
      "id": "US-012",
      "title": "Extract Round Matching Logic",
      "description": "Extract round matching logic. Same fuzzy round matching duplicated in two files.",
      "acceptanceCriteria": [
        "Create lib/utils/round_matcher.dart",
        "Move matching logic from lib/screens/history_screen.dart:87-129",
        "Move matching logic from lib/widgets/handicap_chart.dart:162-204",
        "Update both files to use shared utility",
        "Round matching works identically in both places",
        "Single source of truth for matching logic"
      ],
      "priority": 4,
      "passes": false,
      "dependsOn": []
    },
    {
      "id": "US-013",
      "title": "Semantic Labels",
      "description": "Add semantic labels for accessibility. Screen readers can't describe UI elements.",
      "acceptanceCriteria": [
        "Add semanticLabel to all Icon widgets",
        "Wrap complex widgets in Semantics with descriptions",
        "Priority screens: home, plotting, session detail",
        "Enable TalkBack/VoiceOver and can navigate app",
        "All buttons/icons have spoken labels",
        "Score displays read as 'Score: 278 out of 300'"
      ],
      "priority": 5,
      "passes": false,
      "dependsOn": []
    },
    {
      "id": "US-014",
      "title": "Touch Target Sizes",
      "description": "Fix touch target sizes. Some buttons/icons are smaller than 48px minimum.",
      "acceptanceCriteria": [
        "Audit all interactive elements for 48x48px minimum",
        "Fix undersized targets (wrap in SizedBox or increase padding)",
        "Priority: home screen menu items, settings buttons, small icons",
        "All tappable elements are at least 48x48px",
        "No accidental taps on wrong targets"
      ],
      "priority": 5,
      "passes": false,
      "dependsOn": []
    }
  ],
  "metadata": {
    "updatedAt": "2026-01-17T09:16:04.463Z"
  }
}