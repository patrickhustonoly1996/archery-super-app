<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badge Triggers - What Activates Each Badge</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Share Tech Mono', 'Courier New', monospace;
            background: #121212;
            color: #fff;
            padding: 40px;
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            font-family: 'VT323', monospace;
            color: #FFD700;
            font-size: 48px;
            text-align: center;
            margin-bottom: 40px;
        }
        h2 {
            font-family: 'VT323', monospace;
            color: #FFD700;
            font-size: 32px;
            margin-top: 40px;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        .badge-section {
            margin-bottom: 60px;
        }
        .trigger-card {
            background: #1E1E1E;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin: 16px 0;
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        .trigger-card:hover {
            border-color: #FFD700;
        }
        .badge-preview {
            min-width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .badge-info {
            flex: 1;
        }
        .badge-name {
            font-family: 'VT323', monospace;
            font-size: 24px;
            color: #FFD700;
            margin-bottom: 8px;
        }
        .trigger-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
            margin-top: 12px;
            margin-bottom: 4px;
        }
        .trigger-text {
            color: #00FF88;
            font-size: 14px;
            line-height: 1.6;
        }
        .location-text {
            color: #00BFFF;
            font-size: 14px;
        }
        .code-ref {
            font-size: 12px;
            color: #666;
            font-style: italic;
            margin-top: 8px;
        }
        .tier-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        .tier-badge {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        /* Badge SVGs */
        .streak-arrow {
            width: 60px;
            height: 60px;
        }
        .trophy { width: 50px; height: 60px; }
        .crown { width: 60px; height: 40px; }
        .star { width: 50px; height: 50px; }
        .medal { width: 45px; height: 60px; }
        .gem { width: 40px; height: 40px; }

        /* Flow diagram */
        .flow-diagram {
            background: #1E1E1E;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 30px;
            margin: 30px 0;
        }
        .flow-step {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }
        .flow-box {
            background: #2A2A2A;
            border: 2px solid #444;
            padding: 15px 20px;
            border-radius: 8px;
            flex: 1;
        }
        .flow-box.trigger {
            border-color: #00FF88;
            background: rgba(0, 255, 136, 0.1);
        }
        .flow-box.check {
            border-color: #00BFFF;
            background: rgba(0, 191, 255, 0.1);
        }
        .flow-box.badge {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.1);
        }
        .flow-arrow {
            color: #666;
            font-size: 24px;
        }
        .flow-label {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        /* Summary table */
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .summary-table th, .summary-table td {
            border: 1px solid #333;
            padding: 12px;
            text-align: left;
        }
        .summary-table th {
            background: #2A2A2A;
            color: #FFD700;
            font-family: 'VT323', monospace;
            font-size: 16px;
        }
        .summary-table td {
            font-size: 13px;
        }
        .summary-table tr:hover {
            background: rgba(255, 215, 0, 0.05);
        }

        @import url('https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&display=swap');
    </style>
</head>
<body>
    <h1>BADGE TRIGGERS</h1>
    <p style="text-align: center; color: #888; margin-bottom: 40px;">What user actions cause each badge to appear</p>

    <!-- Summary Table -->
    <h2>Quick Reference</h2>
    <table class="summary-table">
        <tr>
            <th>Badge Type</th>
            <th>Trigger Event</th>
            <th>Where It Shows</th>
            <th>Code Location</th>
        </tr>
        <tr>
            <td style="color: #FF6B35;">Streak Arrows</td>
            <td>7/14/30/60/90 consecutive training days</td>
            <td>XP Celebration overlay</td>
            <td>skills_provider.dart:517-550</td>
        </tr>
        <tr>
            <td style="color: #FFD700;">Crowns</td>
            <td>Reaching level 10/25/50/75/99</td>
            <td>Level Up Celebration</td>
            <td>skills_provider.dart:159-178</td>
        </tr>
        <tr>
            <td style="color: #00FF88;">Stars (Practice PB)</td>
            <td>New personal best in practice session</td>
            <td>XP Celebration overlay</td>
            <td>skills_provider.dart:391-410</td>
        </tr>
        <tr>
            <td style="color: #00BFFF;">Stars (Competition PB)</td>
            <td>New personal best in competition</td>
            <td>XP Celebration overlay</td>
            <td>skills_provider.dart:370-388</td>
        </tr>
        <tr>
            <td style="color: #C0C0C0;">Trophies</td>
            <td>Competition placement/achievement</td>
            <td>Session Complete screen</td>
            <td>session_complete_screen.dart</td>
        </tr>
        <tr>
            <td style="color: #9C27B0;">Medals</td>
            <td>Achieving AGB classification (A3-GMB)</td>
            <td>Session Complete screen</td>
            <td>session_complete_screen.dart:113-176</td>
        </tr>
        <tr>
            <td style="color: #00FF88;">Excellent Form</td>
            <td>Bow training with avg feedback ≤3 AND ≥30s hold</td>
            <td>XP Celebration overlay</td>
            <td>skills_provider.dart:437-449</td>
        </tr>
        <tr>
            <td style="color: #00BFFF;">Full Plot</td>
            <td>Plotting all arrows in a session</td>
            <td>XP Celebration overlay</td>
            <td>session_complete_screen.dart:73</td>
        </tr>
    </table>

    <!-- Detailed Trigger Flows -->
    <h2>Streak Arrows - Training Consistency</h2>
    <div class="flow-diagram">
        <div class="flow-step">
            <div class="flow-box trigger">
                <div class="flow-label">User Action</div>
                <strong>Complete any training session</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Scoring, bow training, or breath training
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box check">
                <div class="flow-label">System Check</div>
                <strong>awardConsistencyXp()</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Counts consecutive days<br>
                    streakDays parameter checked
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box badge">
                <div class="flow-label">Badge Shown When</div>
                <strong>streakDays == 7, 14, or 30</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    XpBadgeCelebration.show() triggered
                </div>
            </div>
        </div>
    </div>

    <div class="trigger-card">
        <div class="badge-preview">
            <svg class="streak-arrow" viewBox="0 0 60 60">
                <polygon points="30,5 40,25 35,25 35,45 25,45 25,25 20,25" fill="#8B4513" stroke="#5D3A1A" stroke-width="2"/>
                <polygon points="30,5 38,20 32,18 30,5 28,18 22,20" fill="#FF6B35"/>
                <polygon points="25,45 30,55 35,45" fill="#CD853F" stroke="#8B4513" stroke-width="1"/>
            </svg>
        </div>
        <div class="badge-info">
            <div class="badge-name">STREAK ARROWS</div>
            <div class="trigger-label">Trigger Condition</div>
            <div class="trigger-text">
                Training on consecutive calendar days. The streak counter resets if you miss a day.
            </div>
            <div class="tier-list">
                <span class="tier-badge" style="background: #FF6B35; color: #000;">7 days = Spark</span>
                <span class="tier-badge" style="background: #FF3366; color: #fff;">14 days = Blaze</span>
                <span class="tier-badge" style="background: #FF0044; color: #fff;">30 days = Inferno</span>
                <span class="tier-badge" style="background: #9933FF; color: #fff;">60 days = Phoenix</span>
                <span class="tier-badge" style="background: #FFD700; color: #000;">90 days = Legendary</span>
            </div>
            <div class="trigger-label">Where It Appears</div>
            <div class="location-text">Full-screen XP Celebration overlay after session complete</div>
            <div class="code-ref">skills_provider.dart lines 517-550</div>
        </div>
    </div>

    <h2>Crowns - Level Milestones</h2>
    <div class="flow-diagram">
        <div class="flow-step">
            <div class="flow-box trigger">
                <div class="flow-label">User Action</div>
                <strong>Earn XP in any skill</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Any XP-awarding activity
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box check">
                <div class="flow-label">System Check</div>
                <strong>awardXp() → levelFromXp()</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Calculates new level from total XP<br>
                    Compares oldLevel vs newLevel
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box badge">
                <div class="flow-label">Badge Shown When</div>
                <strong>newLevel > oldLevel</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    LevelUpCelebration queued<br>
                    Crown tier based on new level
                </div>
            </div>
        </div>
    </div>

    <div class="trigger-card">
        <div class="badge-preview">
            <svg class="crown" viewBox="0 0 60 40">
                <path d="M5,35 L10,15 L20,25 L30,5 L40,25 L50,15 L55,35 Z" fill="#FFD700" stroke="#DAA520" stroke-width="2"/>
                <circle cx="10" cy="15" r="4" fill="#FF0044"/>
                <circle cx="30" cy="5" r="5" fill="#FF0044"/>
                <circle cx="50" cy="15" r="4" fill="#FF0044"/>
                <rect x="5" y="32" width="50" height="6" fill="#DAA520"/>
            </svg>
        </div>
        <div class="badge-info">
            <div class="badge-name">CROWNS - LEVEL MILESTONES</div>
            <div class="trigger-label">Trigger Condition</div>
            <div class="trigger-text">
                Leveling up any skill. Crown tier determined by the level reached.
            </div>
            <div class="tier-list">
                <span class="tier-badge" style="background: #B87333; color: #000;">Level 10 = Copper</span>
                <span class="tier-badge" style="background: #C0C0C0; color: #000;">Level 25 = Silver</span>
                <span class="tier-badge" style="background: #FFD700; color: #000;">Level 50 = Gold</span>
                <span class="tier-badge" style="background: #00BFFF; color: #000;">Level 75 = Platinum</span>
                <span class="tier-badge" style="background: #9933FF; color: #fff;">Level 99 = Legendary</span>
            </div>
            <div class="trigger-label">Where It Appears</div>
            <div class="location-text">Level Up Celebration screen (scroll banner)</div>
            <div class="code-ref">skills_provider.dart lines 159-178, level_up_celebration.dart</div>
        </div>
    </div>

    <h2>Stars - Personal Bests</h2>
    <div class="flow-diagram">
        <div class="flow-step">
            <div class="flow-box trigger">
                <div class="flow-label">User Action</div>
                <strong>Complete a scoring session</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Practice or competition round
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box check">
                <div class="flow-label">System Check</div>
                <strong>recordPbIfNew()</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Gets best score for this round type<br>
                    Compares: is current > previous best?
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box badge">
                <div class="flow-label">Badge Shown When</div>
                <strong>score > currentBest.score</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Green star for practice PB<br>
                    Blue star for competition PB
                </div>
            </div>
        </div>
    </div>

    <div class="trigger-card">
        <div class="badge-preview">
            <svg class="star" viewBox="0 0 50 50">
                <polygon points="25,2 31,18 48,18 34,29 40,46 25,36 10,46 16,29 2,18 19,18"
                         fill="#00FF88" stroke="#00CC66" stroke-width="2"/>
            </svg>
        </div>
        <div class="badge-info">
            <div class="badge-name">STARS - PERSONAL BESTS</div>
            <div class="trigger-label">Trigger Condition</div>
            <div class="trigger-text">
                Scoring higher than your previous best for that specific round type.<br>
                PBs are tracked separately for each round (Portsmouth, WA720, York, etc.)
            </div>
            <div class="tier-list">
                <span class="tier-badge" style="background: #00FF88; color: #000;">Practice PB = Green Star</span>
                <span class="tier-badge" style="background: #00BFFF; color: #000;">Competition PB = Blue Star</span>
                <span class="tier-badge" style="background: #FFD700; color: #000;">Round Record = Gold Star</span>
            </div>
            <div class="trigger-label">Where It Appears</div>
            <div class="location-text">XP Celebration overlay with "Personal Best!" or "New PB!" message</div>
            <div class="code-ref">skills_provider.dart lines 370-410, recordPbIfNew() at 610-651</div>
        </div>
    </div>

    <h2>Medals - AGB Classifications</h2>
    <div class="flow-diagram">
        <div class="flow-step">
            <div class="flow-box trigger">
                <div class="flow-label">User Action</div>
                <strong>Complete a qualifying round</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    AGB-recognized round with profile set
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box check">
                <div class="flow-label">System Check</div>
                <strong>checkAndRecordScore()</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Calculates handicap from score<br>
                    Checks vs classification thresholds<br>
                    Needs 2 qualifying scores
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box badge">
                <div class="flow-label">Badge Shown When</div>
                <strong>Score meets classification threshold</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    "1st qualifying score" or<br>
                    "Classification Complete!"
                </div>
            </div>
        </div>
    </div>

    <div class="trigger-card">
        <div class="badge-preview">
            <svg class="medal" viewBox="0 0 45 60">
                <path d="M15,0 L30,0 L30,15 L22.5,20 L15,15 Z" fill="#E53935"/>
                <circle cx="22.5" cy="38" r="18" fill="#FFD700" stroke="#DAA520" stroke-width="2"/>
                <circle cx="22.5" cy="38" r="12" fill="#DAA520"/>
                <text x="22.5" y="43" text-anchor="middle" font-family="VT323" font-size="12" fill="#FFD700">MB</text>
            </svg>
        </div>
        <div class="badge-info">
            <div class="badge-name">MEDALS - AGB CLASSIFICATIONS</div>
            <div class="trigger-label">Trigger Condition</div>
            <div class="trigger-text">
                Achieving a score that meets AGB classification thresholds.<br>
                Requires: gender, age category, and bow type set in profile.<br>
                <strong>Two qualifying scores required</strong> for full classification.
            </div>
            <div class="tier-list">
                <span class="tier-badge" style="background: #EEEEEE; color: #000;">A3 → A1 (White)</span>
                <span class="tier-badge" style="background: #212121; color: #fff;">B3 → B1 (Black)</span>
                <span class="tier-badge" style="background: #42A5F5; color: #000;">MB (Blue)</span>
                <span class="tier-badge" style="background: #E53935; color: #fff;">BMB (Red)</span>
                <span class="tier-badge" style="background: #FFD700; color: #000;">SMB (Gold)</span>
                <span class="tier-badge" style="background: #9C27B0; color: #fff;">GMB (Purple)</span>
            </div>
            <div class="trigger-label">Where It Appears</div>
            <div class="location-text">Classification card on Session Complete screen</div>
            <div class="code-ref">session_complete_screen.dart lines 113-176, classification_provider.dart</div>
        </div>
    </div>

    <h2>Excellent Form - Bow Training Quality</h2>
    <div class="flow-diagram">
        <div class="flow-step">
            <div class="flow-box trigger">
                <div class="flow-label">User Action</div>
                <strong>Complete bow training</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    Hold exercises with feedback ratings
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box check">
                <div class="flow-label">System Check</div>
                <strong>awardBowTrainingXp()</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    avgFeedback = (shaking + structure + rest) / 3<br>
                    Check: avgFeedback ≤ 3 AND totalHold ≥ 30s
                </div>
            </div>
            <span class="flow-arrow">→</span>
            <div class="flow-box badge">
                <div class="flow-label">Badge Shown When</div>
                <strong>Both conditions met</strong>
                <div style="font-size: 12px; color: #888; margin-top: 4px;">
                    "Excellent form!" celebration
                </div>
            </div>
        </div>
    </div>

    <div class="trigger-card">
        <div class="badge-preview">
            <svg viewBox="0 0 50 50" width="50" height="50">
                <circle cx="25" cy="25" r="20" fill="none" stroke="#00FF88" stroke-width="3"/>
                <path d="M15,25 L22,32 L35,18" stroke="#00FF88" stroke-width="4" fill="none"/>
            </svg>
        </div>
        <div class="badge-info">
            <div class="badge-name">EXCELLENT FORM</div>
            <div class="trigger-label">Trigger Condition</div>
            <div class="trigger-text">
                Complete bow training with:<br>
                • Average feedback rating ≤ 3 (1=best, 5=worst)<br>
                • Total hold time ≥ 30 seconds<br>
                Both conditions must be met.
            </div>
            <div class="trigger-label">Where It Appears</div>
            <div class="location-text">XP Celebration overlay with green accent</div>
            <div class="code-ref">skills_provider.dart lines 437-449</div>
        </div>
    </div>

    <h2>Summary: The Award Flow</h2>
    <div class="flow-diagram" style="padding: 40px;">
        <div style="text-align: center; margin-bottom: 30px;">
            <div style="font-family: VT323; font-size: 24px; color: #FFD700;">User completes an activity</div>
            <div style="color: #888; font-size: 14px;">Scoring session, bow training, breath training</div>
        </div>

        <div style="display: flex; justify-content: center; gap: 40px; flex-wrap: wrap;">
            <div style="text-align: center; padding: 20px; border: 2px solid #444; border-radius: 8px; width: 200px;">
                <div style="color: #00FF88; font-size: 14px;">CHECK 1</div>
                <div style="color: #fff; margin: 10px 0;">Streak Days?</div>
                <div style="color: #FF6B35;">→ Streak Arrow</div>
            </div>

            <div style="text-align: center; padding: 20px; border: 2px solid #444; border-radius: 8px; width: 200px;">
                <div style="color: #00FF88; font-size: 14px;">CHECK 2</div>
                <div style="color: #fff; margin: 10px 0;">Level Up?</div>
                <div style="color: #FFD700;">→ Crown</div>
            </div>

            <div style="text-align: center; padding: 20px; border: 2px solid #444; border-radius: 8px; width: 200px;">
                <div style="color: #00FF88; font-size: 14px;">CHECK 3</div>
                <div style="color: #fff; margin: 10px 0;">New PB?</div>
                <div style="color: #00FF88;">→ Star</div>
            </div>

            <div style="text-align: center; padding: 20px; border: 2px solid #444; border-radius: 8px; width: 200px;">
                <div style="color: #00FF88; font-size: 14px;">CHECK 4</div>
                <div style="color: #fff; margin: 10px 0;">Classification?</div>
                <div style="color: #9C27B0;">→ Medal</div>
            </div>

            <div style="text-align: center; padding: 20px; border: 2px solid #444; border-radius: 8px; width: 200px;">
                <div style="color: #00FF88; font-size: 14px;">CHECK 5</div>
                <div style="color: #fff; margin: 10px 0;">Excellent Form?</div>
                <div style="color: #00FF88;">→ Checkmark</div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <div style="color: #888;">↓</div>
            <div style="font-family: VT323; font-size: 20px; color: #FFD700; margin-top: 10px;">
                Matching badges queued for celebration
            </div>
        </div>
    </div>

    <h2>XP Sources (What Earns XP)</h2>
    <table class="summary-table">
        <tr>
            <th>Skill</th>
            <th>XP Source</th>
            <th>Amount</th>
        </tr>
        <tr>
            <td style="color: #FFD700;">Archery</td>
            <td>Complete a round (based on handicap)</td>
            <td>Higher handicap = more XP to improve</td>
        </tr>
        <tr>
            <td style="color: #00BFFF;">Volume</td>
            <td>Shoot arrows</td>
            <td>1 XP per arrow</td>
        </tr>
        <tr>
            <td style="color: #9C27B0;">Analysis</td>
            <td>Plot arrows on target face</td>
            <td>Based on plotted arrow count</td>
        </tr>
        <tr>
            <td style="color: #E53935;">Competition</td>
            <td>Compete (marked as competition session)</td>
            <td>Based on score vs practice average</td>
        </tr>
        <tr>
            <td style="color: #00FF88;">Bow Fitness</td>
            <td>Bow training holds</td>
            <td>Based on hold time + feedback quality</td>
        </tr>
        <tr>
            <td style="color: #42A5F5;">Breath Work</td>
            <td>Breath training exercises</td>
            <td>Based on hold/exhale times</td>
        </tr>
        <tr>
            <td style="color: #FF6B35;">Consistency</td>
            <td>Train multiple days per week</td>
            <td>Bonus for streaks</td>
        </tr>
        <tr>
            <td style="color: #8B4513;">Equipment</td>
            <td>Log equipment changes, save kit snapshots</td>
            <td>25 XP per action</td>
        </tr>
    </table>

    <div style="margin-top: 60px; padding: 20px; background: #1E1E1E; border-radius: 8px; text-align: center;">
        <div style="color: #888; font-size: 14px;">
            Badge triggers document for Archery Super App<br>
            All badges are earned through in-app activity - no purchases required
        </div>
    </div>
</body>
</html>
